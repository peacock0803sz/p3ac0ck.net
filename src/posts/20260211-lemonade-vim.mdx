---
slug: 20260211-lemonade-vim
title: "SSHå…ˆã®Vimã¨ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’å…±æœ‰ã™ã‚‹Short Tips (feat. lemonade)"
lang: ja
emoji: "ğŸ‹"
pubDate: 2026-02-11
---

ã“ã®è¨˜äº‹ã¯ [Vimé§…ä¼](https://vim-jp.org/ekiden) ã® [2026-02-11](https://vim-jp.org/ekiden#article-2026-02-11) ã®è¨˜äº‹ã§ã™ã€‚

## å¯¾è±¡èª­è€…

æ™®æ®µVim/Neovim (ä»¥ä¸‹ã€å˜ã«Vimã¨è¡¨è¨˜)ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦(=`.vimrc` ã‚’æ›¸ã„ã¦)ä½¿ã£ã¦ã„ã‚‹äºº

## ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³

SSHå…ˆã§ã‚‚ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸVimã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’ãƒ›ã‚¹ãƒˆã¨å…±æœ‰ã—ãŸã„

## ãƒ‡ãƒ¢ (Neovim)

<video controls muted autoplay transition:persist>
  <source src="https://img.p3ac0ck.net/figs/20260211-lemonade-vim.mp4" type="video/mp4" />
</video>

## æ–¹æ³•

æ³¨: SSHãƒ›ã‚¹ãƒˆå´ã‚’ **Server**, SSHå…ˆã‚’ **Client** ã¨è¡¨è¨˜ã—ã¾ã™

### 1: lemonadeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[lemonade](https://github.com/lemonade-command/lemonade) ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«(SSHå…ƒãƒ»å…ˆã©ã¡ã‚‰ã«ã‚‚)

### 2: Lemonade Serverèµ·å‹•

ãƒ›ã‚¹ãƒˆå´ã§ `lemonade server --allow=0.0.0.0/0` ã¨å®Ÿè¡Œ (ã¾ãŸã¯Appendixã®ã‚ˆã†ã«ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’ä½œæˆã—èµ·å‹•)

### 3: Vim Pluginã®ä½œæˆ

Clientå´ã§ä»¥ä¸‹ã®ã‚ˆã†ã« `lemonade.vim` ã‚’ä½œæˆ

```vim
" Clipboard configuration for lemonade (SSH remote clipboard)
if exists('$SSH_CLIENT') && executable('lemonade')
  " ãƒªãƒ¢ãƒ¼ãƒˆãƒ›ã‚¹ãƒˆã®IPã‚’æŠ½å‡º (ä¾‹: '192.168.1.100 54321 22' -> '192.168.1.100')
  let s:remote_host = split($SSH_CLIENT)[0]

  if !empty(s:remote_host)
    let g:clipboard = {
          \ 'name': 'lemonade',
          \ 'copy': {
          \   '+': ['lemonade', '--host', s:remote_host, 'copy'],
          \   '*': ['lemonade', '--host', s:remote_host, 'copy'],
          \ },
          \ 'paste': {
          \   '+': ['lemonade', '--host', s:remote_host, 'paste'],
          \   '*': ['lemonade', '--host', s:remote_host, 'paste'],
          \ },
          \ 'cache_enabled': v:false,
          \ }

    if exists('g:loaded_clipboard_provider')
      unlet g:loaded_clipboard_provider
      runtime autoload/provider/clipboard.vim
    endif

    set clipboard=unnamed
  endif
elseif has('clipboard')
  set clipboard=unnamed
endif
```

#### æ³¨: `lemonade.vim` ã®ä¿å­˜å ´æ‰€

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦èª­ã¿è¾¼ã¾ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå ´æ‰€ã«ä½œæˆã—ã¦ãã ã•ã„

* Vim: `$HOME/.vim/plugin/` [Cf. `load-plugins` (Vimæ—¥æœ¬èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)](https://vim-jp.org/vimdoc-ja/starting.html#load-plugins)
* Neovim: `$HOME/.config/nvim/plugin/` [Cf. `load-plugins` (Neovimå…¬å¼ãƒ˜ãƒ«ãƒ—)](https://neovim.io/doc/user/starting.html#load-plugins)

## Appendix: NixOS / nix-darwinç”¨ãƒ‡ãƒ¼ãƒ¢ãƒ³

### For nix-darwin

Full Version: https://github.com/peacock0803sz/dotfiles/blob/fc735b76cee9405733500468fa14dc1e08e59b59/.config/nix/nix-darwin/lemonade.nix

```nix
{ ... }@inputs: {
  launchd.user.agents.lemonade = {
    serviceConfig = {
      EnvironmentVariables = {
        LANG = "ja_JP.UTF-8";
        LC_ALL = "ja_JP.UTF-8";
      };
      ProgramArguments = [
        "${inputs.pkgs.lemonade}/bin/lemonade"
        "server"
        "--allow=0.0.0.0/0"
      ];
      KeepAlive = true;
      StandardErrorPath = "/tmp/lemonade.err.log";
      StandardOutPath = "/tmp/lemonade.out.log";
    };
  };
}
```

### For NixOS

Full Version: https://github.com/peacock0803sz/dotfiles/blob/fc735b76cee9405733500468fa14dc1e08e59b59/.config/nix/nixos/lemonade.nix

```nix
{ ... }@inputs:
{
  systemd.services.lemonade = {
    description = "Lemonade clipboard server";
    wantedBy = [ "multi-user.target" ];
    after = [ "network.target" ];
    serviceConfig = {
      Type = "simple";
      User = inputs.username;
      Environment = [
        "LANG=ja_JP.UTF-8"
        "LC_ALL=ja_JP.UTF-8"
      ];
      ExecStart = "${inputs.pkgs.lemonade}/bin/lemonade server --allow=0.0.0.0/0";
      Restart = "always";
      RestartSec = 5;
      StandardOutput = "append:/tmp/lemonade.out.log";
      StandardError = "append:/tmp/lemonade.err.log";
    };
  };
}
```
